# Habilita compresión para recursos estáticos y HTML
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain text/html text/xml text/css text/javascript application/javascript application/json
</IfModule>

# Controla expiraciones de contenido estático para aprovechar el versionado automático
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access plus 1 hour"
    ExpiresByType text/css "access plus 7 days"
    ExpiresByType application/javascript "access plus 7 days"
    ExpiresByType text/javascript "access plus 7 days"
    ExpiresByType image/svg+xml "access plus 30 days"
</IfModule>

# Evita que navegadores guarden versiones obsoletas de HTML/PHP dinámicos
<IfModule mod_headers.c>
    <FilesMatch "\.(php|html)$">
        Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
        Header set Pragma "no-cache"
        Header set Expires "Thu, 01 Jan 1970 00:00:00 GMT"
    </FilesMatch>

    # Los recursos estáticos pueden cachearse con seguridad gracias al versionado ?v=
    <FilesMatch "\.(css|js)$">
        Header set Cache-Control "public, max-age=31536000, immutable"
    </FilesMatch>
</IfModule>

# ---- NO GZIP/NO DEFLATE para binarios ----
<IfModule mod_deflate.c>
  SetEnvIfNoCase Request_URI "\.(?:docx|dotx|docm|pdf|zip)$" no-gzip dont-vary
</IfModule>

<IfModule mod_filter.c>
  AddOutputFilterByType REMOVE_DEFLATE application/vnd.openxmlformats-officedocument.wordprocessingml.document
  AddOutputFilterByType REMOVE_DEFLATE application/pdf
  AddOutputFilterByType REMOVE_DEFLATE application/zip
</IfModule>

# Content-Types explícitos
AddType application/vnd.openxmlformats-officedocument.wordprocessingml.document .docx
AddType application/pdf .pdf
AddType application/zip .zip
